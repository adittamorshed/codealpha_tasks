# -*- coding: utf-8 -*-
"""CodeAlpha_Sales-Prediction-using-Python.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ccuALOMtuY7MeJRyMqdf_SOC1tak6JZr

importing libraries:
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

from sklearn.model_selection import train_test_split, GridSearchCV
from sklearn.linear_model import LinearRegression
from sklearn.ensemble import RandomForestRegressor, GradientBoostingRegressor
from sklearn.metrics import r2_score, mean_absolute_error, mean_squared_error

"""load dataset and it's information:"""

df = pd.read_csv("Advertising.csv")
df.info()
df.isnull().sum()

"""understand the dataset:"""

sns.scatterplot(x='TV', y='Sales', data=df)
sns.heatmap(df.corr(), annot=True)

"""prepare feaures and target:"""

X = df[['TV', 'Radio', 'Newspaper']]
y = df['Sales']

"""split dataset into training and testing:"""

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

"""train Linear Regression model :"""

model = LinearRegression()
model.fit(X_train, y_train)

"""test Linear Regression model:"""

y_pred = model.predict(X_test)

"""check the accuracy (r2 score, mean absolute error)"""

print(r2_score(y_test, y_pred))
print(mean_absolute_error(y_test, y_pred))

"""graphing for Linear Regression   :"""

plt.scatter(y_test, y_pred)

"""training Random Forest Regressor model:"""

rf = RandomForestRegressor(n_estimators=200, random_state=42)
rf.fit(X_train, y_train)
y_pred_rf = rf.predict(X_test)

"""evaluate Random Forest Regressor model:"""

mae_rf = mean_absolute_error(y_test, y_pred_rf)
rmse_rf = np.sqrt(mean_squared_error(y_test, y_pred_rf))
r2_rf = r2_score(y_test, y_pred_rf)

print("Random Forest Evaluation")
print("MAE  :", mae_rf)
print("RMSE :", rmse_rf)
print("R² Score :", r2_rf)

"""graphing with comparison for Random Forest Regressor model:"""

plt.figure(figsize=(8,4))
plt.scatter(y_test, y_pred_rf, alpha=0.7)
plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'r--')
plt.xlabel("Actual Sales")
plt.ylabel("Predicted Sales")
plt.title("Random Forest: Actual vs Predicted")
plt.show()

"""training Gradient Boosting Regressor model:"""

gb = GradientBoostingRegressor(random_state=42)
gb.fit(X_train, y_train)
y_pred_gb = gb.predict(X_test)

"""evaluate Gradient Boosting Regressor model:"""

mae_gb = mean_absolute_error(y_test, y_pred_gb)
rmse_gb = np.sqrt(mean_squared_error(y_test, y_pred_gb))
r2_gb = r2_score(y_test, y_pred_gb)

print("Gradient Boosting Evaluation")
print("MAE  :", mae_gb)
print("RMSE :", rmse_gb)
print("R² Score :", r2_gb)

"""graphing with comparison for Gradient Boosting Regressor model:"""

plt.figure(figsize=(8,4))
plt.scatter(y_test, y_pred_gb, alpha=0.7)
plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'r--')
plt.xlabel("Actual Sales")
plt.ylabel("Predicted Sales")
plt.title("Gradient Boosting: Actual vs Predicted")
plt.show()

"""convert data into time series:"""

df['Date'] = pd.date_range(start='2020-01-01', periods=len(df), freq='D')
df = df.set_index('Date')

"""using ARIMA model:"""

from statsmodels.tsa.arima.model import ARIMA

arima_model = ARIMA(df['Sales'], order=(2,1,2))
arima_fit = arima_model.fit()

arima_forecast = arima_fit.forecast(steps=10)
print(arima_forecast)

"""using Prophet model:"""

from prophet import Prophet

df_prophet = df.reset_index()[['Date','Sales']]
df_prophet.columns = ['ds','y']

prophet_model = Prophet()
prophet_model.fit(df_prophet)

future = prophet_model.make_future_dataframe(periods=10)
forecast = prophet_model.predict(future)

forecast[['ds','yhat']].tail(10)

"""graphing time series forecast for ARIMA model:"""

plt.figure(figsize=(10,5))
plt.plot(df['Sales'], label='Original Sales')
plt.plot(arima_forecast, label='ARIMA Forecast')
plt.legend()
plt.show()

"""graphing time series forecast for Prophet model:"""

prophet_model.plot(forecast)
plt.show()